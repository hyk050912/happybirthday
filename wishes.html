<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Happy Birthday - 祝福</title>
	<link rel="stylesheet" href="assets/style.css">
</head>

<body>
	<canvas id="pinkboard" class="full-canvas"></canvas>
	<div class="left-dots"><span></span><span></span><span></span></div>

	<div class="wishes-card card">
		<div class="title-cn" style="color:#d0576b;">祝<span data-username></span>陛下生日快乐</div>
		<ul id="wishEditor" class="bullets">
			<li>🎉 虽然认识的时间不长，这里还是想真诚的祝福陛下：</li>
			<li>💞 祝你美丽依旧，快乐多多。</li>
			<li>🍰 愿你想有所成，愿有所愿。</li>
			<li>🎂 愿你天黑有灯，下雨有伞。</li>
			<li>🍻 愿你工作顺利，小朋友少捣乱。</li>
			<li>🍸 愿你身边终有良人相伴。</li>
			<li>🔍 祝你开开心心，祝你生日快乐！</li>
			<li>🔍 祝你开开心心，祝你生日快乐！</li>
			<li>🔍 祝你开开心心，祝你生日快乐！</li>
			<li>📣 重要的事情说三遍哈</li>
		</ul>

	</div>

	<!-- BGM: 点击按钮播放/暂停（多数浏览器禁止自动播放） -->
	<audio id="bgm" src="assets/bgm.mp3" preload="auto" loop autoplay playsinline class="hidden"></audio>
	<button id="bgmToggle" class="audio-btn" aria-label="音乐">
		<svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path d="M9 18V6l10-2v12" stroke="#d0576b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
			<path d="M9 10l10-2" stroke="#d0576b" stroke-width="2" stroke-linecap="round"/>
			<circle cx="7" cy="18" r="2" stroke="#d0576b" stroke-width="2"/>
			<circle cx="19" cy="16" r="2" stroke="#d0576b" stroke-width="2"/>
		</svg>
	</button>


	<script src="assets/app.js"></script>
	<script>
		HB.initWishesPage();
	</script>
	<script>
		// soft pink heart particles as in login
		(function (canvas) {
			var settings = { particles: { length: 450, duration: 4, velocity: 100, effect: -0.75, size: 30 } };
			var Point = function(x,y){ this.x=x||0; this.y=y||0; };
			Point.prototype.clone=function(){ return new Point(this.x,this.y); };
			Point.prototype.length=function(l){ if(l===undefined) return Math.sqrt(this.x*this.x+this.y*this.y); this.normalize(); this.x*=l; this.y*=l; return this; };
			Point.prototype.normalize=function(){ var l=this.length(); this.x/=l; this.y/=l; return this; };
			var Particle=function(){ this.position=new Point(); this.velocity=new Point(); this.acceleration=new Point(); this.age=0; };
			Particle.prototype.initialize=function(x,y,dx,dy){ this.position.x=x; this.position.y=y; this.velocity.x=dx; this.velocity.y=dy; this.acceleration.x=dx*settings.particles.effect; this.acceleration.y=dy*settings.particles.effect; this.age=0; };
			Particle.prototype.update=function(dt){ this.position.x+=this.velocity.x*dt; this.position.y+=this.velocity.y*dt; this.velocity.x+=this.acceleration.x*dt; this.velocity.y+=this.acceleration.y*dt; this.age+=dt; };
			Particle.prototype.draw=function(c, img){ function ease(t){ return --t*t*t+1; } var s=img.width*ease(this.age/settings.particles.duration); c.globalAlpha=1-this.age/settings.particles.duration; c.drawImage(img,this.position.x-s/2,this.position.y-s/2,s,s); };
			var ParticlePool=(function(){ var p,fa=0,ff=0,d=settings.particles.duration; function Pool(len){ p=new Array(len); for(var i=0;i<p.length;i++) p[i]=new Particle(); } Pool.prototype.add=function(x,y,dx,dy){ p[ff].initialize(x,y,dx,dy); ff++; if(ff==p.length) ff=0; if(fa==ff) fa++; if(fa==p.length) fa=0; }; Pool.prototype.update=function(dt){ var i; if(fa<ff){ for(i=fa;i<ff;i++) p[i].update(dt);} if(ff<fa){ for(i=fa;i<p.length;i++) p[i].update(dt); for(i=0;i<ff;i++) p[i].update(dt);} while(p[fa].age>=d && fa!=ff){ fa++; if(fa==p.length) fa=0; } }; Pool.prototype.draw=function(c,img){ var i; if(fa<ff){ for(i=fa;i<ff;i++) p[i].draw(c,img);} if(ff<fa){ for(i=fa;i<p.length;i++) p[i].draw(c,img); for(i=0;i<ff;i++) p[i].draw(c,img);} }; return Pool; })();
			var context = canvas.getContext("2d"), particles = new ParticlePool(settings.particles.length), particleRate = settings.particles.length / settings.particles.duration, time;
			function pointOnHeart(t){ return new Point(160*Math.pow(Math.sin(t),3), 130*Math.cos(t)-50*Math.cos(2*t)-20*Math.cos(3*t)-10*Math.cos(4*t)+25); }
			var image=(function(){ var c=document.createElement('canvas'), cx=c.getContext('2d'); c.width=settings.particles.size; c.height=settings.particles.size; function to(t){ var point=pointOnHeart(t); point.x=settings.particles.size/2+(point.x*settings.particles.size)/350; point.y=settings.particles.size/2-(point.y*settings.particles.size)/350; return point; } cx.beginPath(); var t=-Math.PI; var point=to(t); cx.moveTo(point.x,point.y); while(t<Math.PI){ t+=0.01; point=to(t); cx.lineTo(point.x,point.y);} cx.closePath(); cx.fillStyle='pink'; cx.fill(); var img=new Image(); img.src=c.toDataURL(); return img; })();
			function render(){ requestAnimationFrame(render); var newTime=new Date().getTime()/1000, dt=newTime-(time||newTime); time=newTime; context.clearRect(0,0,canvas.width,canvas.height); var amount=particleRate*dt; for(var i=0;i<amount;i++){ var pos=pointOnHeart(Math.PI-2*Math.PI*Math.random()); var dir=pos.clone().length(settings.particles.velocity); particles.add(canvas.width/2+pos.x, canvas.height/2-pos.y, dir.x, -dir.y);} particles.update(dt); particles.draw(context,image);} function onResize(){ canvas.width=canvas.clientWidth; canvas.height=canvas.clientHeight; } window.onresize=onResize; setTimeout(function(){ onResize(); render(); },10);
		})(document.getElementById('pinkboard'));
	</script>
</body>

</html>


